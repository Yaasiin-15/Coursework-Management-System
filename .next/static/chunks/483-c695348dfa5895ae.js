"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[483],{84478:function(e,t,a){a.d(t,{Z:function(){return N}});var r=a(57437),s=a(2265),n=a(99376),l=a(27648),i=a(14938),d=a(48736),c=a(99397),o=a(96215),m=a(95805),x=a(71769),u=a(98728),h=a(10407),g=a(92451),b=a(43241);function f(){let[e,t]=(0,s.useState)(null),{isCollapsed:a,setIsCollapsed:f}=(0,b.A)(),y=(0,n.usePathname)();if((0,s.useEffect)(()=>{let e=localStorage.getItem("user");e&&t(JSON.parse(e))},[]),!e)return null;let j=[{name:"Dashboard",href:"/dashboard",icon:i.Z,roles:["student","teacher","admin"]},{name:"Assignments",href:"/assignments",icon:d.Z,roles:["student","teacher","admin"]},{name:"Create Assignment",href:"/assignments/create",icon:c.Z,roles:["teacher","admin"]},{name:"Analytics",href:"/analytics",icon:o.Z,roles:["teacher","admin"]},{name:"Classes",href:"/classes",icon:m.Z,roles:["teacher","admin"]},{name:"Courses",href:"/courses",icon:x.Z,roles:["student","teacher","admin"]},{name:"Admin Panel",href:"/admin",icon:u.Z,roles:["admin"]},{name:"Settings",href:"/settings",icon:u.Z,roles:["student","teacher","admin"]},{name:"Test Features",href:"/test-features",icon:u.Z,roles:["student","teacher","admin"]}].filter(t=>t.roles.includes(e.role));return(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 shadow-lg h-screen fixed left-0 top-0 z-40 transition-all duration-300 ".concat(a?"w-16":"w-64"),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700",children:[!a&&(0,r.jsx)("h1",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:"CMS"}),(0,r.jsx)("button",{onClick:()=>f(!a),className:"p-1 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors",children:a?(0,r.jsx)(h.Z,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"}):(0,r.jsx)(g.Z,{className:"w-5 h-5 text-gray-600 dark:text-gray-300"})})]}),(0,r.jsx)("nav",{className:"mt-6",children:(0,r.jsx)("ul",{className:"space-y-2 px-3",children:j.map(e=>{let t=e.icon,s=y===e.href;return(0,r.jsx)("li",{children:(0,r.jsxs)(l.default,{href:e.href,className:"flex items-center px-3 py-2 rounded-lg transition-colors group ".concat(s?"bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400":"text-gray-600 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 hover:text-gray-900 dark:hover:text-white"),children:[(0,r.jsx)(t,{className:"w-5 h-5 ".concat(a?"mx-auto":"mr-3")}),!a&&(0,r.jsx)("span",{className:"font-medium",children:e.name})]})},e.name)})})}),!a&&(0,r.jsx)("div",{className:"absolute bottom-0 left-0 right-0 p-4 border-t dark:border-gray-700 bg-gray-50 dark:bg-gray-700/50",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-sm font-medium",children:e.name.charAt(0).toUpperCase()})}),(0,r.jsxs)("div",{className:"ml-3",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900 dark:text-white",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 capitalize",children:e.role})]})]})})]})}var y=a(44696),j=a(69734),p=a(23504);function k(e){let{children:t}=e,[a,l]=(0,s.useState)(null),[i,d]=(0,s.useState)(!0),{isCollapsed:c}=(0,b.A)(),o=(0,n.useRouter)();return((0,s.useEffect)(()=>{let e=localStorage.getItem("token"),t=localStorage.getItem("user");if(!e||!t){o.push("/login");return}l(JSON.parse(t)),d(!1)},[o]),i)?(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center transition-colors",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Loading..."})]})}):a?(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 transition-colors",children:[(0,r.jsx)(f,{}),(0,r.jsxs)("div",{className:"transition-all duration-300 ".concat(c?"ml-16":"ml-64"),children:[(0,r.jsx)(y.Z,{}),(0,r.jsx)("main",{className:"p-4 sm:p-6",children:t})]})]}):null}function N(e){let{children:t}=e;return(0,r.jsx)(j.ThemeProvider,{children:(0,r.jsx)(p.NotificationProvider,{children:(0,r.jsx)(b.SidebarProvider,{children:(0,r.jsx)(k,{children:t})})})})}},89823:function(e,t,a){a.d(t,{Z:function(){return c}});var r=a(57437),s=a(2265),n=a(92735),l=a(92369),i=a(83229),d=a(48736);function c(e){let{assignmentId:t,maxMarks:a,onClose:c}=e,[o,m]=(0,s.useState)([]),[x,u]=(0,s.useState)(null),[h,g]=(0,s.useState)(0),[b,f]=(0,s.useState)(""),[y,j]=(0,s.useState)(!0),[p,k]=(0,s.useState)(!1);(0,s.useEffect)(()=>{N()},[t]),(0,s.useEffect)(()=>{x&&(g(x.marks||0),f(x.feedback||""))},[x]);let N=async()=>{try{let e=localStorage.getItem("token"),a=await fetch("/api/assignments/".concat(t,"/submissions"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.json();m(e.submissions),e.submissions.length>0&&u(e.submissions[0])}}catch(e){console.error("Error fetching submissions:",e)}finally{j(!1)}},v=async(e,t)=>{try{let a=localStorage.getItem("token"),r=await fetch("/api/files/download?path=".concat(encodeURIComponent(e)),{headers:{Authorization:"Bearer ".concat(a)}});if(r.ok){let e=await r.blob(),a=window.URL.createObjectURL(e),s=document.createElement("a");s.href=a,s.download=t,document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(a),document.body.removeChild(s)}}catch(e){console.error("Error downloading file:",e)}},w=async()=>{if(x){k(!0);try{let e=localStorage.getItem("token");(await fetch("/api/submissions/".concat(x._id,"/grade"),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({marks:h,feedback:b})})).ok&&(m(e=>e.map(e=>e._id===x._id?{...e,marks:h,feedback:b,status:"graded"}:e)),u(e=>e?{...e,marks:h,feedback:b,status:"graded"}:null))}catch(e){console.error("Error saving grade:",e)}finally{k(!1)}}},S=async()=>{try{let e=localStorage.getItem("token"),a=await fetch("/api/assignments/".concat(t,"/bulk-download"),{headers:{Authorization:"Bearer ".concat(e)}});if(a.ok){let e=await a.blob(),r=window.URL.createObjectURL(e),s=document.createElement("a");s.href=r,s.download="assignment-".concat(t,"-submissions.zip"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(r),document.body.removeChild(s)}}catch(e){console.error("Error downloading bulk files:",e)}};return y?(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 p-6 rounded-lg",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray-600 dark:text-gray-300",children:"Loading submissions..."})]})}):(0,r.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,r.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-6xl h-5/6 flex flex-col",children:[(0,r.jsxs)("div",{className:"p-6 border-b dark:border-gray-700 flex items-center justify-between",children:[(0,r.jsxs)("h2",{className:"text-xl font-bold text-gray-900 dark:text-white",children:["Grading Interface (",o.length," submissions)"]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)("button",{onClick:S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 flex items-center space-x-2",children:[(0,r.jsx)(n.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Bulk Download"})]}),(0,r.jsx)("button",{onClick:c,className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Close"})]})]}),(0,r.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,r.jsx)("div",{className:"w-1/3 border-r dark:border-gray-700 overflow-y-auto",children:(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900 dark:text-white mb-4",children:"Submissions"}),0===o.length?(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No submissions yet"}):(0,r.jsx)("div",{className:"space-y-2",children:o.map(e=>(0,r.jsxs)("div",{onClick:()=>u(e),className:"p-3 rounded-lg cursor-pointer transition-colors ".concat((null==x?void 0:x._id)===e._id?"bg-blue-100 dark:bg-blue-900/30 border-blue-300 dark:border-blue-600":"bg-gray-50 dark:bg-gray-700 hover:bg-gray-100 dark:hover:bg-gray-600"),children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 text-gray-500"}),(0,r.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.studentId.name}),(0,r.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat("graded"===e.status?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"late"===e.status?"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400"),children:e.status})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mt-1",children:e.fileName}),(0,r.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1",children:new Date(e.submittedAt).toLocaleString()}),void 0!==e.marks&&(0,r.jsxs)("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mt-1",children:[e.marks,"/",a," marks"]})]},e._id))})]})}),(0,r.jsx)("div",{className:"flex-1 flex flex-col",children:x?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"p-6 border-b dark:border-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:x.studentId.name}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:x.studentId.email})]}),(0,r.jsxs)("button",{onClick:()=>v(x.fileUrl,x.fileName),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:[(0,r.jsx)(n.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:"Download"})]})]})}),(0,r.jsx)("div",{className:"flex-1 p-6 overflow-y-auto",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:["Marks (out of ",a,")"]}),(0,r.jsx)("input",{type:"number",min:"0",max:a,value:h,onChange:e=>g(Number(e.target.value)),className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Feedback"}),(0,r.jsx)("textarea",{value:b,onChange:e=>f(e.target.value),rows:8,className:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent dark:bg-gray-700 dark:text-white",placeholder:"Provide detailed feedback for the student..."})]}),(0,r.jsxs)("button",{onClick:w,disabled:p,className:"flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,r.jsx)(i.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{children:p?"Saving...":"Save Grade"})]})]})})]}):(0,r.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center text-gray-500 dark:text-gray-400",children:[(0,r.jsx)(d.Z,{className:"w-12 h-12 mx-auto mb-4"}),(0,r.jsx)("p",{children:"Select a submission to start grading"})]})})})]})]})})}},43241:function(e,t,a){a.d(t,{A:function(){return i},SidebarProvider:function(){return l}});var r=a(57437),s=a(2265);let n=(0,s.createContext)(void 0);function l(e){let{children:t}=e,[a,l]=(0,s.useState)(!1);return(0,r.jsx)(n.Provider,{value:{isCollapsed:a,setIsCollapsed:l},children:t})}function i(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useSidebar must be used within a SidebarProvider");return e}}}]);